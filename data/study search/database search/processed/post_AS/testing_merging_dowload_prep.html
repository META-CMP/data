<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Franz Prante">

<title>Abstract screening report and full text download data preparation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="testing_merging_dowload_prep_files/libs/clipboard/clipboard.min.js"></script>
<script src="testing_merging_dowload_prep_files/libs/quarto-html/quarto.js"></script>
<script src="testing_merging_dowload_prep_files/libs/quarto-html/popper.min.js"></script>
<script src="testing_merging_dowload_prep_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="testing_merging_dowload_prep_files/libs/quarto-html/anchor.min.js"></script>
<link href="testing_merging_dowload_prep_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="testing_merging_dowload_prep_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="testing_merging_dowload_prep_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="testing_merging_dowload_prep_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="testing_merging_dowload_prep_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#summary" id="toc-summary" class="nav-link active" data-scroll-target="#summary">Summary</a>
  <ul class="collapse">
  <li><a href="#tests" id="toc-tests" class="nav-link" data-scroll-target="#tests">Tests</a></li>
  <li><a href="#analyses-of-screening" id="toc-analyses-of-screening" class="nav-link" data-scroll-target="#analyses-of-screening">Analyses of screening</a></li>
  </ul></li>
  <li><a href="#code-and-output-for-testing-merging-analyzing-and-preparing-full-text-download-of-abstract-screening-dataset" id="toc-code-and-output-for-testing-merging-analyzing-and-preparing-full-text-download-of-abstract-screening-dataset" class="nav-link" data-scroll-target="#code-and-output-for-testing-merging-analyzing-and-preparing-full-text-download-of-abstract-screening-dataset">Code and output for testing, merging, analyzing and preparing full text download of abstract screening dataset</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Abstract screening report and full text download data preparation</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Franz Prante </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>(All based on code below)</p>
<section id="tests" class="level3">
<h3 class="anchored" data-anchor-id="tests">Tests</h3>
<section id="valid-screener-notes" class="level4">
<h4 class="anchored" data-anchor-id="valid-screener-notes">Valid screener notes?</h4>
<section id="screener-1" class="level5">
<h5 class="anchored" data-anchor-id="screener-1">Screener 1</h5>
<ul>
<li>For screener 1, there is one “22”, which is marked as relevant. No correction needed.
<ul>
<li>Abstract: “We empirically investigate asset substitution of economic sectors in response to either liquidity demand or monetary policy shock, using the Japanese flow of funds data. Our interest is in responses of portfolio items of six sectors, financial institutions, central government, public corporations and local government, corporate business, personal, and overseas. It is reasonable to identify both shocks in liquidity demand and monetary policy, using recursive VAR models where the variable ordering is the real GDP, the GDP deflator, the commodity price index, the call rate, the monetary base and each balance-sheet variable. We interpret that structural innovations in the monetary base as liquidity demand shocks and those in the call rate as monetary policy shocks. The responses to either the monetary-policy or liquidity demand shocks are different among sectors, among the transaction items, and between the periods before and after the bubble. Among the sectors, the personal sector exhibits the delayed responses, which are consistent with the limited participation model. The transaction items of the corporate business sector show vivid responses to the shocks. Between the two sub-periods, the stocks held by the financial institutions show clearly different responses.”</li>
</ul></li>
<li>For screener 1, there is one “00”, which is marked as irrelevant. No correction needed.
<ul>
<li>Abstract: “This article investigates the pricing behaviour of Turkish firms over the period 1988-2006 on the basis of firm-level micro data. The duration of prices is found to be 3.9 months on average. There is no clear heterogeneity across main groupings in the frequency of price changes, but more dependence on imported goods reduces price stickiness. Price decreases are less frequent than price increases, indicating downward rigidity in prices. There is evidence in favour of both time and state-dependent price setting behaviours. Further, there is a low degree of synchronization of price changes across firms, whereas price increases tend to be more synchronized than price decreases. Ordered probit models show that price adjustments depend on the type of the shock: the pass-through of a change in the cost is faster than changing demand. Besides, estimated probabilities of price adjustments with 5-years rolling windows reveal that inflation targeting has succeeded in bringing down the probability of price increases, whereas downward price rigidity has not weakened yet.”</li>
</ul></li>
</ul>
</section>
<section id="screener-2" class="level5">
<h5 class="anchored" data-anchor-id="screener-2">Screener 2</h5>
<ul>
<li>For screener 1, there is one “22”, which is marked as relevant. No correction needed.”
<ul>
<li>Abstract: “Existing theory and evidence on the effects of monetary policy are reviewed. Substantial room for disagreement among economists remains. New evidence, based on multivariate time series studies of several countries, is presented. While certain patterns in the data consistent with effective monetary policy are strikingly similar across countries, others, particularly the tendency of interest rate increases to predict high inflation, are harder to reconcile with effective monetary policy.”</li>
</ul></li>
</ul>
</section>
</section>
<section id="do-screener-notes-correctly-correspond-to-in-exclusion-of-studies" class="level4">
<h4 class="anchored" data-anchor-id="do-screener-notes-correctly-correspond-to-in-exclusion-of-studies">Do screener notes correctly correspond to in-/exclusion of studies?</h4>
<section id="screener-1-1" class="level5">
<h5 class="anchored" data-anchor-id="screener-1-1">Screener 1</h5>
<ul>
<li>For screener 1, there is one entry that was excluded though it carries an inclusion note. Correction not necessary because one mistake will only marginally affect the sample.
<ul>
<li>Abstract: “The Nigerian economy attracts abundance of foreign capital inflows and credit supply; hence, an adverse external credit shock might lead to a large decrease of external inflows due to global credit tightening, which may leave the domestic economy in deep recession. In this case, domestic monetary policy tools should be preferred to mitigate the external adverse effect on the domestic economy and stimulate investment. As a result, an important issue of concern in this study is how can the use of monetary policy tools mitigate the effect of external credit shocks on economic growth in Nigeria? In answering this question, this study attempted to assess the influence of monetary policy tools on external credit and economic growth nexus in Nigeria, using annual data covering 36 years for the period 1980–2015. The study adopted the Cobb–Douglas production function and estimated a specified model using autoregressive distributed lag cointegration approach. The study found out that cash reserve requirement, which is credit policy easing, is significant in growing the Nigerian economy, as compared to monetary policy rate. The implication of this is that, if credit policy easing is properly implemented, it could be efficient in offsetting adverse external credit shocks.”</li>
</ul></li>
<li>For screener 1, there is one entry that is included though it carries an exclusion note. But no correction necessary, as the entry will be excluded in the full text screening phase.
<ul>
<li>Abstract: “This paper analyzes the importance of monetary and fiscal policy shocks in explaining U.S. macroeconomic fluctuations, and establishes new stylized facts. The novelty of our empirical analysis is that we jointly consider both monetary and fiscal policy, whereas the existing literature only focuses on either one or the other. Our main findings are twofold: fiscal shocks are relatively more important in explaining medium cycle fluctuations whereas monetary policy shocks are relatively more important in explaining business cycle fluctuations, and failing to recognize that both monetary and fiscal policy simultaneously affect macroeconomic variables might incorrectly attribute the fluctuations to the wrong source.”</li>
</ul></li>
</ul>
</section>
<section id="screener-2-1" class="level5">
<h5 class="anchored" data-anchor-id="screener-2-1">Screener 2</h5>
<ul>
<li>For screener 2, there are 3 entries that were excluded though they carries inclusion notes. Correction not necessary because this mistake will only marginally affect the sample.</li>
<li>Abstracts:</li>
</ul>
<ol type="1">
<li>“This study investigates the effect of monetary policy shocks in New Zealand and Australia on their respective exchange rates from 1985 to 1998 using vector autoregression methodology. The results show that monetary policy shocks do contribute to the variability of both exchange rates, but these movements are not always consistent with theory. In particular, there is little support for the overshooting hypothesis. Also the results show that the exchange rates do not always move in the direction normally anticipated, particularly for New Zealand. A contraction in monetary policy may lead to a depreciation of the domestic currency rather than an appreciation.”</li>
<li>“This South African case study controls for the fiscal side of the economy using government borrowing as a potential accelerator of asymmetry in a monetary function that follows Taylor?s rule. Through the linear and non-linear ARDL framework, we find significant asymmetry effects of monetary policy on output and inflation, respectively. We also find government borrowing as an important underlying source of asymmetries in the response of macroeconomic fundamentals to monetary policy shocks in South Africa. Thus, we recommend that monetary authorities consider not only the effectiveness or otherwise of monetary policy instruments to affect the target policy goals, but also the fact that not all the target variables react in a similar way to expansionary and contractionary monetary policy shocks.”</li>
<li>“The perception that inflation dynamics in Sub-Saharan Africa (SSA) are driven by supply shocks implies a limited role for monetary policy in influencing inflation in the short run. SSA’s rapid growth, its integration with the global economy, changes in the policy frameworks, among others, in the last decade suggest that the drivers of inflation may have changed. We quantitatively analyze inflation dynamics in SSA using a Global VAR model, which incorporates trade and financial linkages among economies, as well as the role of regional and global demand and inflationary spillovers. We find that in the past 25 years, the main drivers of inflation have been domestic supply shocks and shocks to exchange rate and monetary variables; but that, in recent years, the contribution of these shocks to inflation has fallen. Domestic demand pressures as well as global shocks, and particularly shocks to output, however, have played a larger role in driving inflation over the last decade. We also show that country characteristics matter–the extent of oil and food imports, vulnerability to weather shocks, economic importance of agriculture, trade openness and policy regime, among others, help in explaining the role of shocks.”</li>
</ol>
<ul>
<li>No invalid inclusions for screener 2.</li>
</ul>
</section>
</section>
<section id="tests-before-and-after-merging-screener-data" class="level4">
<h4 class="anchored" data-anchor-id="tests-before-and-after-merging-screener-data">Tests before and after merging screener data</h4>
<ul>
<li>“record_id” and “key” are correctly matching for both Screener 1 and Screener 2 data (i.e.&nbsp;ids and keys were not corrupted during data transformations and processing)</li>
<li>merged data correctly matches original screener data (i.e.&nbsp;merging code is valid)</li>
</ul>
</section>
</section>
<section id="analyses-of-screening" class="level3">
<h3 class="anchored" data-anchor-id="analyses-of-screening">Analyses of screening</h3>
<ul>
<li>5826 entries were screened by either screener 1 or 2 (or both). 2034 were included by screener 1. 2148 were included by screener 2.</li>
<li>2540 were marked as relevant by at least one screener.</li>
</ul>
<section id="screener-1-proportions-of-in-exclusions-notes" class="level4">
<h4 class="anchored" data-anchor-id="screener-1-proportions-of-in-exclusions-notes">Screener 1 proportions of in-/exclusions notes</h4>
<p>Screener 1 notes (%)</p>
<p><img src="images/Bildschirmfoto%202023-05-15%20um%2014.10.54.png" class="img-fluid"></p>
</section>
<section id="screener-2-proportions-of-in-exclusions-notes" class="level4">
<h4 class="anchored" data-anchor-id="screener-2-proportions-of-in-exclusions-notes">Screener 2 proportions of in-/exclusions notes</h4>
<p>Screener 2 notes (%)</p>
<p><img src="images/Bildschirmfoto%202023-05-15%20um%2014.03.01.png" class="img-fluid"></p>
</section>
<section id="agreement-and-overlap" class="level4">
<h4 class="anchored" data-anchor-id="agreement-and-overlap">Agreement and overlap</h4>
<ul>
<li>1642 entries were included by both screeners.</li>
<li>2500 entries were excluded by both screeners.</li>
<li>335 entries were included by screener 1 but excluded by screener 2.</li>
<li>477 entries were included by screener 2 but excluded by screener 1.</li>
<li>4954 entries were screened by both screeners. Of these, 1977 , i.e.&nbsp;39.9 %, were included by Screener 1 and 2119 , i.e.&nbsp;42.8 %, were included by Screener 2.</li>
<li>726 entries were screened exclusively by Screener 1. Of these, 57 were included, i.e.&nbsp;7.9 %.</li>
<li>146 entries were screened exclusively by Screener 2. Of these, 29 were included, i.e.&nbsp;19.9 %.</li>
</ul>
</section>
<section id="bibtex-key-creation" class="level4">
<h4 class="anchored" data-anchor-id="bibtex-key-creation">Bibtex-Key creation</h4>
<ul>
<li>There are 44 duplicate Bibtex-keys which need to be corrected when downloading the PDFs.</li>
<li>There are also quite a few Bibtex-keys which have a bibtex-incompatible syntax. These would also need to be corrected.</li>
</ul>
</section>
<section id="randomization-and-packages-creation-for-full-text-download" class="level4">
<h4 class="anchored" data-anchor-id="randomization-and-packages-creation-for-full-text-download">Randomization and packages creation for full text download</h4>
<ul>
<li><p>Order of entries has been randomized</p></li>
<li><p>Data is split into a number <code>.xslx</code> files with max of 100 entries in each file.</p>
<p><code>.xslx</code> files contain only information relevant for retrieving PDFs and empty columns for notes regarding availability.</p></li>
</ul>
</section>
</section>
</section>
<section id="code-and-output-for-testing-merging-analyzing-and-preparing-full-text-download-of-abstract-screening-dataset" class="level2">
<h2 class="anchored" data-anchor-id="code-and-output-for-testing-merging-analyzing-and-preparing-full-text-download-of-abstract-screening-dataset">Code and output for testing, merging, analyzing and preparing full text download of abstract screening dataset</h2>
<div class="cell" data-file="testing_and_merging_of_AS_data.R">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(readr)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># library(openxlsx)</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Importing screener 1 data (all)</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>s1_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">"data/study search/database search/processed/post_AS/screener_1_data/asreview_dataset_all_abstract-screening-morpep-meta-cmp-screener-1.csv"</span>))</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Importing screener 2 data (all)</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>s2_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">"data/study search/database search/processed/post_AS/screener_2_data/asreview_dataset_all_abstract-screening-morpep-meta-cmp-screener-2.csv"</span>))</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Some consistency tests before merging </span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Screener 1: only valid screener notes?</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(s1_data<span class="sc">$</span>exported_notes_1)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">'For screener 1, there is one "22", which is marked as relevant. No correction needed.'</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(s1_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(exported_notes_1<span class="sc">==</span><span class="st">"22"</span>)) <span class="co"># Inspecting the entry.</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(s1_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(exported_notes_1<span class="sc">==</span><span class="st">"22"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">`</span><span class="at">abstract note</span><span class="st">`</span>)) <span class="co"># Inspecting the abstract</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">'For screener 1, there is one "00", which is marked as irrelevant. No correction needed.'</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(s1_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(exported_notes_1<span class="sc">==</span><span class="st">"00"</span>)) <span class="co"># Inspecting the entry.</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(s1_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(exported_notes_1<span class="sc">==</span><span class="st">"00"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">`</span><span class="at">abstract note</span><span class="st">`</span>)) <span class="co"># Inspecting the abstract</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Exclusion seems valid."</span>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Screener 2: only valid screener notes?</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(s2_data<span class="sc">$</span>exported_notes_1)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">'For screener 1, there is one "22", which is marked as relevant. No correction needed.'</span>)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(s2_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(exported_notes_1<span class="sc">==</span><span class="st">"22"</span>)) <span class="co"># Inspecting the entry.</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(s2_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(exported_notes_1<span class="sc">==</span><span class="st">"22"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">`</span><span class="at">abstract note</span><span class="st">`</span>)) <span class="co"># Inspecting abstract.</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Do screener 1 notes correctly correspond to in-/exclusion of studies?</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>inclusion_notes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"111"</span>, <span class="st">"112"</span>, <span class="st">"121"</span>, <span class="st">"211"</span>, <span class="st">"122"</span>, <span class="st">"212"</span>, <span class="st">"221"</span>, <span class="st">"222"</span>) <span class="co"># Index of entries that carry inclusion notes</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>s1_included_notes <span class="ot">&lt;-</span> s1_data<span class="sc">$</span>exported_notes_1 <span class="sc">%in%</span> inclusion_notes </span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(s1_data<span class="sc">$</span>included[s1_included_notes] <span class="sc">!=</span> <span class="dv">1</span>) </span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"For screener 1, there is one entry that was excluded though it carries an inclusion note. Correction not necessary because one mistake will only marginally affect the sample."</span>)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(s1_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(included <span class="sc">==</span> <span class="st">"0"</span> <span class="sc">&amp;</span> exported_notes_1 <span class="sc">%in%</span> inclusion_notes )) <span class="co"># Inspecting the entry</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(s1_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(included <span class="sc">==</span> <span class="st">"0"</span> <span class="sc">&amp;</span> exported_notes_1 <span class="sc">%in%</span> inclusion_notes ) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">`</span><span class="at">abstract note</span><span class="st">`</span>)) <span class="co"># Inspecting the abstract</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>exclusion_notes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"000"</span>, <span class="st">"001"</span>, <span class="st">"002"</span>, <span class="st">"010"</span>, <span class="st">"011"</span>, <span class="st">"012"</span>, <span class="st">"020"</span>, <span class="st">"021"</span>, <span class="st">"022"</span>, <span class="st">"100"</span>, <span class="st">"101"</span>, <span class="st">"102"</span>, <span class="st">"110"</span>, <span class="st">"120"</span>, <span class="st">"200"</span>, <span class="st">"201"</span>, <span class="st">"202"</span>, <span class="st">"210"</span>, <span class="st">"220"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>) <span class="co"># Index of entries that carry exclusion notes</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>s1_excluded_notes <span class="ot">&lt;-</span> s1_data<span class="sc">$</span>exported_notes_1 <span class="sc">%in%</span> exclusion_notes </span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(s1_data<span class="sc">$</span>included[s1_excluded_notes] <span class="sc">!=</span> <span class="dv">0</span>) </span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"For screener 1, there is one entry that is included though it carries an exclusion note. But no correction necessary, as the entry will be excluded in the full text screening phase."</span>)</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(s1_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(included <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> exported_notes_1 <span class="sc">%in%</span> exclusion_notes)) <span class="co"># Inspect the entry.</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(s1_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(included <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> exported_notes_1 <span class="sc">%in%</span> exclusion_notes ) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">`</span><span class="at">abstract note</span><span class="st">`</span>)) <span class="co"># Inspecting the abstract</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Do screener 2 notes correctly correspond to in-/exclusion of studies?</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>s2_included_notes <span class="ot">&lt;-</span> s2_data<span class="sc">$</span>exported_notes_1 <span class="sc">%in%</span> inclusion_notes</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(s2_data<span class="sc">$</span>included[s2_included_notes] <span class="sc">!=</span> <span class="dv">1</span>) </span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"For screener 2, there are 3 entries that were excluded though they carries inclusion notes. Correction not necessary because this mistake will only marginally affect the sample."</span>)</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(s2_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(included <span class="sc">==</span> <span class="st">"0"</span> <span class="sc">&amp;</span> exported_notes_1 <span class="sc">%in%</span> inclusion_notes )) <span class="co"># Inspecting the entry</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(s2_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(included <span class="sc">==</span> <span class="st">"0"</span> <span class="sc">&amp;</span> exported_notes_1 <span class="sc">%in%</span> inclusion_notes ) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">`</span><span class="at">abstract note</span><span class="st">`</span>)) <span class="co"># Inspecting the abstract</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>s2_excluded_notes <span class="ot">&lt;-</span> s2_data<span class="sc">$</span>exported_notes_1 <span class="sc">%in%</span> exclusion_notes</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(s2_data<span class="sc">$</span>included[s2_excluded_notes] <span class="sc">!=</span> <span class="dv">0</span>) </span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"No invalid inclusions for screener 2."</span>)</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="do">## Merging the data</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Test that record id and key are matching for both s1_data and s2_data</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(<span class="fu">sort</span>(<span class="fu">paste0</span>(s1_data<span class="sc">$</span>record_id, s1_data<span class="sc">$</span>key)) <span class="sc">==</span> <span class="fu">sort</span>(<span class="fu">paste0</span>(s2_data<span class="sc">$</span>record_id, s2_data<span class="sc">$</span>key)))</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge s1_data and s2_data based on all variables that must have equal values, i.e. those that have not been created by ASReview</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>columns <span class="ot">&lt;-</span> <span class="fu">colnames</span>(s1_data) <span class="co"># These are the column names of the dataframe (they are equal for s1_data and s2_data, see: 'sum(colnames(s1_data) != colnames(s2_data))')</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>matching_columns <span class="ot">&lt;-</span> <span class="fu">head</span>(columns, <span class="sc">-</span><span class="dv">3</span>) <span class="co"># These are the columns that have not been created by ASReview</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>merged_data <span class="ot">&lt;-</span> <span class="fu">merge</span>(s1_data, s2_data, <span class="at">by =</span> matching_columns, <span class="at">all =</span> T, <span class="at">sort =</span> F, <span class="at">suffixes =</span> <span class="fu">c</span>(<span class="st">".s1"</span>,<span class="st">".s2"</span>)) <span class="co"># This merges the dataframes by all columns that must have equal values. Columns with separate values are retained.</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Test that merged data correctly matches original data</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(<span class="fu">na.omit</span>(merged_data[, <span class="fu">c</span>(<span class="st">"record_id"</span>, <span class="st">"key"</span>, <span class="st">"included.s1"</span>, <span class="st">"exported_notes_1.s1"</span>)]) <span class="sc">==</span> <span class="fu">na.omit</span>(s1_data[, <span class="fu">c</span>(<span class="st">"record_id"</span>, <span class="st">"key"</span>, <span class="st">"included"</span>, <span class="st">"exported_notes_1"</span>)])) <span class="co"># For screener 1, test that record_id, key, included and exported_notes_1 in the merged data matches the original entries</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>from_merged <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(merged_data[, <span class="fu">c</span>(<span class="st">"record_id"</span>, <span class="st">"key"</span>, <span class="st">"included.s2"</span>, <span class="st">"exported_notes_1.s2"</span>)])</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>from_merged <span class="ot">&lt;-</span> from_merged[<span class="fu">order</span>(from_merged<span class="sc">$</span>record_id),]</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>from_s2 <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(s2_data[, <span class="fu">c</span>(<span class="st">"record_id"</span>, <span class="st">"key"</span>, <span class="st">"included"</span>, <span class="st">"exported_notes_1"</span>)])      </span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>from_s2 <span class="ot">&lt;-</span> from_s2[<span class="fu">order</span>(from_s2<span class="sc">$</span>record_id),]</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(from_merged <span class="sc">==</span> from_s2) <span class="co"># For screener 2, test that record_id, key, included and exported_notes_1 in the merged data matches the original entries (4 steps before are necessary, because "merged_data" is sorted as s1_data)</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyses of screening</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>s1_s2_agreement_data <span class="ot">&lt;-</span> merged_data <span class="sc">%&gt;%</span>   </span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(key, included.s1, included.s2, exported_notes_1.s1, exported_notes_1.s2) <span class="sc">%&gt;%</span> </span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(included.s1) <span class="sc">|</span> <span class="sc">!</span><span class="fu">is.na</span>(included.s2))</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="fu">nrow</span>(s1_s2_agreement_data), <span class="st">"entries were screened by either screener 1 or 2."</span>, <span class="fu">sum</span>(s1_s2_agreement_data<span class="sc">$</span>included.s1, <span class="at">na.rm =</span> T), <span class="st">"were included by screener 1."</span>, <span class="fu">sum</span>(s1_s2_agreement_data<span class="sc">$</span>included.s2, <span class="at">na.rm =</span> T), <span class="st">"were included by screener 2"</span>) </span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="fu">nrow</span>(s1_s2_agreement_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(included.s1<span class="sc">==</span><span class="dv">1</span> <span class="sc">|</span> included.s2<span class="sc">==</span><span class="dv">1</span>)), <span class="st">"were marked as relevant by at least one screener."</span>)</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="fu">nrow</span>(s1_s2_agreement_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(included.s1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> included.s2<span class="sc">==</span><span class="dv">1</span>)), <span class="st">"were marked as relevant by both screeners in aggreement."</span>)</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a><span class="co"># Screener 1 proportions of in-/exclusions notes</span></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(s1_s2_agreement_data<span class="sc">$</span>exported_notes_1.s1)) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(s1_s2_agreement_data<span class="sc">$</span>exported_notes_1.s1)) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Screener 1 notes (%)"</span>)</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a><span class="co"># Screener 2 proportions of in-/exclusions notes</span></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(s1_s2_agreement_data<span class="sc">$</span>exported_notes_1.s2)) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(s1_s2_agreement_data<span class="sc">$</span>exported_notes_1.s2)) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Screener 2 notes (%)"</span>)</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a><span class="co"># Agreement and overlap</span></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a><span class="co"># Included by both screeners</span></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>included_both <span class="ot">&lt;-</span> s1_s2_agreement_data <span class="sc">%&gt;%</span> </span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(included.s1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> included.s2 <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="fu">nrow</span>(included_both), <span class="st">"entries were included by both screeners."</span>)</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a><span class="co"># Excluded by both screeners </span></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>excluded_both <span class="ot">&lt;-</span> s1_s2_agreement_data <span class="sc">%&gt;%</span> </span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(included.s1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> included.s2 <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="fu">nrow</span>(excluded_both), <span class="st">"entries were excluded by both screeners."</span>)</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a><span class="co"># Included by screener 1, excluded by screener 2</span></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>included_s1_excluded_s2 <span class="ot">&lt;-</span> s1_s2_agreement_data <span class="sc">%&gt;%</span> </span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(included.s1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> included.s2 <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="fu">nrow</span>(included_s1_excluded_s2), <span class="st">"entries were included by screener 1 but excluded by screener 2."</span>)</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a><span class="co"># Included by Screener 2, excluded by screener 1</span></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>included_s2_excluded_s1 <span class="ot">&lt;-</span> s1_s2_agreement_data <span class="sc">%&gt;%</span> </span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(included.s1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> included.s2 <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="fu">nrow</span>(included_s2_excluded_s1), <span class="st">"entries were included by screener 2 but excluded by screener 1."</span>)</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a><span class="co"># Screened by both screener 1 and 2</span></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>both <span class="ot">&lt;-</span> s1_s2_agreement_data <span class="sc">%&gt;%</span> </span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(included.s2) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(included.s1))</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="fu">nrow</span>(both), <span class="st">"entries were screened by both screeners. Of these,"</span>,</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sum</span>(both<span class="sc">$</span>included.s1), <span class="st">", i.e."</span>, <span class="fu">round</span>(<span class="fu">sum</span>(both<span class="sc">$</span>included.s1)<span class="sc">/</span><span class="fu">nrow</span>(both)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">1</span>), <span class="st">"%, were included by Screener 1 and"</span>, <span class="fu">sum</span>(both<span class="sc">$</span>included.s2), <span class="st">", i.e."</span>, <span class="fu">round</span>(<span class="fu">sum</span>(both<span class="sc">$</span>included.s2)<span class="sc">/</span><span class="fu">nrow</span>(both)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">1</span>), <span class="st">"%, were included by Screener 2"</span>)</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a><span class="co"># Exclusively screened by Screener 1</span></span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>only_s1 <span class="ot">&lt;-</span> s1_s2_agreement_data <span class="sc">%&gt;%</span> </span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(included.s2) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(included.s1))</span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="fu">nrow</span>(only_s1), <span class="st">"entries were screened exclusively by Screener 1. Of these,"</span>,</span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sum</span>(only_s1<span class="sc">$</span>included.s1), <span class="st">"were included, i.e."</span>, <span class="fu">round</span>(<span class="fu">sum</span>(only_s1<span class="sc">$</span>included.s1)<span class="sc">/</span><span class="fu">nrow</span>(only_s1)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">1</span>), <span class="st">"%"</span>)</span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a><span class="co"># Exclusively screened by Screener 2</span></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>only_s2 <span class="ot">&lt;-</span> s1_s2_agreement_data <span class="sc">%&gt;%</span> </span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(included.s1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(included.s2))</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="fu">nrow</span>(only_s2), <span class="st">"entries were screened exclusively by Screener 2. Of these,"</span>,</span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sum</span>(only_s2<span class="sc">$</span>included.s2), <span class="st">"were included, i.e."</span>, <span class="fu">round</span>(<span class="fu">sum</span>(only_s2<span class="sc">$</span>included.s2)<span class="sc">/</span><span class="fu">nrow</span>(only_s2)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">1</span>), <span class="st">"%"</span>)</span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting relevant studies</span></span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>relevant_entries <span class="ot">&lt;-</span> merged_data <span class="sc">%&gt;%</span> </span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(included.s1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> included.s2 <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a><span class="co"># Check that number of included in merged relevant entries matches number of included in original screener data</span></span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(relevant_entries<span class="sc">$</span>included.s1, <span class="at">na.rm =</span> T) <span class="sc">==</span> <span class="fu">sum</span>(s1_data<span class="sc">$</span>included, <span class="at">na.rm =</span> T)</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(relevant_entries<span class="sc">$</span>included.s2, <span class="at">na.rm =</span> T) <span class="sc">==</span> <span class="fu">sum</span>(s2_data<span class="sc">$</span>included, <span class="at">na.rm =</span> T)</span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding a bibtex key</span></span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a><span class="co">#' Creates a Bibtex key from a dataframe with publication information.</span></span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a><span class="co">#' This function takes three inputs, year, author and</span></span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a><span class="co">#' title, and creates a Bibtex key for each row in the dataframe. The Bibtex key has</span></span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a><span class="co">#' the format: name-of-first-author_year_first-word-of-title.</span></span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param year A vector with the publication years.</span></span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param author A vector with the authors' names.</span></span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param title A vector with the publication titles.</span></span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a><span class="co">#' @return A vector with the Bibtex keys.</span></span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>create_bibtex_key <span class="ot">&lt;-</span> <span class="cf">function</span>(year, author, title) {</span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Split author names and select first name</span></span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>  first_author <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(author, <span class="st">","</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>]</span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove non-alphanumeric characters from first word of title and convert to lowercase</span></span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>  first_word <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">gsub</span>(<span class="st">"[^[:alnum:]]"</span>, <span class="st">""</span>, <span class="fu">strsplit</span>(title, <span class="st">" "</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>]))</span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine components to create Bibtex key</span></span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(first_author, <span class="st">"_"</span>, year, <span class="st">"_"</span>, first_word)</span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a>relevant_entries<span class="sc">$</span>BibtexKey <span class="ot">&lt;-</span> <span class="fu">apply</span>(relevant_entries, <span class="dv">1</span>, <span class="cf">function</span>(row) {</span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">create_bibtex_key</span>(row[<span class="st">"publication year"</span>], row[<span class="st">"author"</span>], row[<span class="st">"title"</span>])</span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a><span class="co"># Test uniqueness of bibtex keys:</span></span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(<span class="fu">unique</span>(relevant_entries<span class="sc">$</span>BibtexKey)) <span class="sc">==</span> <span class="fu">length</span>(relevant_entries<span class="sc">$</span>BibtexKey)) {</span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">"The generated Bibtex-keys are unique."</span>)</span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">warning</span>(<span class="st">"There are "</span>, <span class="fu">length</span>(relevant_entries<span class="sc">$</span>BibtexKey) <span class="sc">-</span> <span class="fu">length</span>(<span class="fu">unique</span>(relevant_entries<span class="sc">$</span>BibtexKey)), <span class="st">" duplicate Bibtex-keys."</span>)</span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">View</span>(<span class="fu">as.data.frame</span>(relevant_entries<span class="sc">$</span>BibtexKey[<span class="fu">duplicated</span>(relevant_entries<span class="sc">$</span>BibtexKey)]))</span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a><span class="co"># Randomizing the order of the dataset</span></span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random seed</span></span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">364</span>)</span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a><span class="co"># Randomizing the dataframe</span></span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a>randomized_relevant_entries <span class="ot">&lt;-</span> relevant_entries[<span class="fu">sample</span>(<span class="fu">nrow</span>(relevant_entries)),]</span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract data for full text download</span></span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a>data_for_download <span class="ot">&lt;-</span> randomized_relevant_entries <span class="sc">%&gt;%</span> </span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(record_id, key, author, title, <span class="st">`</span><span class="at">publication year</span><span class="st">`</span>, <span class="st">`</span><span class="at">publication title</span><span class="st">`</span>, issue, volume, <span class="st">`</span><span class="at">item type</span><span class="st">`</span>, <span class="st">`</span><span class="at">abstract note</span><span class="st">`</span>, doi, url, BibtexKey) <span class="sc">%&gt;%</span> </span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">most_recent_version_available =</span> <span class="cn">NA</span>, <span class="at">not_available =</span> <span class="cn">NA</span>, <span class="at">retracted =</span> <span class="cn">NA</span>, <span class="at">duplicate =</span> <span class="cn">NA</span>, <span class="at">notes_PDF_download =</span> <span class="cn">NA</span>)</span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a><span class="co"># Create packages for full text download</span></span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a><span class="co">#' Save Dataframe to Multiple Excel Files</span></span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a><span class="co">#' This function saves the entries of a dataframe into xlsx files with a maximum of 100 entries per file.</span></span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param df The dataframe to be saved.</span></span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param file_path The path and filename prefix for the output files.</span></span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a><span class="co">#' @return None</span></span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a><span class="co">#' @export</span></span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a>save_to_xlsx <span class="ot">&lt;-</span> <span class="cf">function</span>(df, file_path) {</span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get number of files to be saved</span></span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a>  n_files <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(<span class="fu">nrow</span>(df) <span class="sc">/</span> <span class="dv">100</span>)</span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Split dataframe into chunks of 100 rows</span></span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a>  df_list <span class="ot">&lt;-</span> <span class="fu">split</span>(df, <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_files, <span class="at">each=</span><span class="dv">100</span>, <span class="at">length.out=</span><span class="fu">nrow</span>(df)))</span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Save each chunk to a separate file</span></span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(df_list)) {</span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a>    file_name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(file_path, <span class="st">"_"</span>, i, <span class="st">".xlsx"</span>)</span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a>    <span class="fu">write.xlsx</span>(df_list[[i]], file_name, <span class="at">rowNames =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true" tabindex="-1"></a><span class="co"># save_to_xlsx(data_for_download, here("data/study search/database search/processed/post_AS/packages_for_full_text_download/study_set"))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>